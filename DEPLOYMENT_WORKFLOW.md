# å¼€å‘éƒ¨ç½²å·¥ä½œæµç¨‹æŒ‡å—

## ğŸš€ å®Œæ•´çš„å¼€å‘åˆ°éƒ¨ç½²æµç¨‹

### 1. å¼€å‘é˜¶æ®µ

#### æœ¬åœ°å¼€å‘
```bash
# 1. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feature/your-feature-name

# 2. è¿›è¡Œå¼€å‘å’Œæµ‹è¯•
npm run dev  # æœ¬åœ°å¼€å‘æœåŠ¡å™¨

# 3. ä»£ç è´¨é‡æ£€æŸ¥
./quality-check.sh all

# 4. æäº¤ä»£ç 
git add .
git commit -m "feat: æ·»åŠ æ–°åŠŸèƒ½æè¿°"
```

#### æ¨é€åˆ°GitHub
```bash
# æ¨é€åˆ°è¿œç¨‹åˆ†æ”¯
git push origin feature/your-feature-name

# åˆ›å»ºPull Request (åœ¨GitHubç½‘é¡µæ“ä½œ)
# ä»£ç å®¡æŸ¥é€šè¿‡ååˆå¹¶åˆ°mainåˆ†æ”¯
```

### 2. éƒ¨ç½²é˜¶æ®µ

#### æ–¹æ¡ˆä¸€ï¼šæ‰‹åŠ¨éƒ¨ç½² (å½“å‰æ–¹æ¡ˆ)
```bash
# 1. æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# 2. åŒæ­¥åˆ°æœåŠ¡å™¨
./deploy-sync.sh --sync-only

# 3. é‡å¯æœåŠ¡
./deploy-sync.sh --restart-only

# 4. éªŒè¯éƒ¨ç½²
./deploy-sync.sh --validate-only
```

#### æ–¹æ¡ˆäºŒï¼šä¸€é”®éƒ¨ç½² (æ¨è)
```bash
# å®Œæ•´éƒ¨ç½²æµç¨‹
./deploy-sync.sh
```

#### æ–¹æ¡ˆä¸‰ï¼šGitHub Actionsè‡ªåŠ¨éƒ¨ç½² (æœªæ¥è§„åˆ’)
```yaml
# .github/workflows/deploy.yml
name: Deploy to Server
on:
  push:
    branches: [ main ]
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Deploy to server
        run: |
          # è‡ªåŠ¨éƒ¨ç½²è„šæœ¬
```

### 3. å¿«é€Ÿä¿®å¤æµç¨‹

#### ç´§æ€¥ä¿®å¤ (Hotfix)
```bash
# 1. åˆ›å»ºhotfixåˆ†æ”¯
git checkout -b hotfix/urgent-fix

# 2. å¿«é€Ÿä¿®å¤
# è¿›è¡Œå¿…è¦çš„ä»£ç ä¿®æ”¹

# 3. å¿«é€Ÿéƒ¨ç½²
git add .
git commit -m "hotfix: ç´§æ€¥ä¿®å¤æè¿°"
git push origin hotfix/urgent-fix

# 4. ç«‹å³éƒ¨ç½²åˆ°æœåŠ¡å™¨
./deploy-sync.sh

# 5. åç»­åˆå¹¶åˆ°mainåˆ†æ”¯
```

### 4. ç¯å¢ƒç®¡ç†

#### ç¯å¢ƒé…ç½®åŒæ­¥
```bash
# åŒæ­¥ç¯å¢ƒé…ç½®
./sync-env.sh production

# æ£€æŸ¥ç¯å¢ƒå·®å¼‚
./sync-env.sh --check
```

#### æ•°æ®åº“è¿ç§»
```bash
# å¦‚æœæœ‰æ•°æ®åº“å˜æ›´
ssh root@152.32.218.174 'cd /var/www/lianyu_ai/backend && npm run migrate'
```

### 5. ç›‘æ§å’Œå›æ»š

#### éƒ¨ç½²åæ£€æŸ¥
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
curl http://152.32.218.174:3001/health

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
ssh root@152.32.218.174 'cd /var/www/lianyu_ai && tail -f logs/app.log'
```

#### å¿«é€Ÿå›æ»š
```bash
# å¦‚æœéƒ¨ç½²å‡ºç°é—®é¢˜ï¼Œå¿«é€Ÿå›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬
git log --oneline -5  # æŸ¥çœ‹æœ€è¿‘5æ¬¡æäº¤
git checkout <previous-commit-hash>
./deploy-sync.sh
```

### 6. è‡ªåŠ¨åŒ–è„šæœ¬

#### åˆ›å»ºå¿«é€Ÿéƒ¨ç½²åˆ«å
```bash
# æ·»åŠ åˆ° ~/.zshrc æˆ– ~/.bashrc
alias deploy='git pull origin main && ./deploy-sync.sh'
alias quick-deploy='./deploy-sync.sh --sync-only && ./deploy-sync.sh --restart-only'
alias check-deploy='./deploy-sync.sh --validate-only'
```

### 7. æœ€ä½³å®è·µ

#### å¼€å‘è§„èŒƒ
- âœ… æ¯æ¬¡ä¿®æ”¹å‰å…ˆæ‹‰å–æœ€æ–°ä»£ç 
- âœ… ä½¿ç”¨æœ‰æ„ä¹‰çš„æäº¤ä¿¡æ¯
- âœ… éƒ¨ç½²å‰è¿›è¡Œä»£ç è´¨é‡æ£€æŸ¥
- âœ… éƒ¨ç½²åéªŒè¯åŠŸèƒ½æ­£å¸¸

#### å®‰å…¨è€ƒè™‘
- ğŸ”’ æ•æ„Ÿä¿¡æ¯ä½¿ç”¨ç¯å¢ƒå˜é‡
- ğŸ”’ å®šæœŸæ›´æ–°ä¾èµ–åŒ…
- ğŸ”’ ç›‘æ§æœåŠ¡å™¨èµ„æºä½¿ç”¨

#### æ€§èƒ½ä¼˜åŒ–
- âš¡ ä½¿ç”¨å¢é‡éƒ¨ç½²å‡å°‘ä¼ è¾“æ—¶é—´
- âš¡ å¯ç”¨gzipå‹ç¼©
- âš¡ é…ç½®CDNåŠ é€Ÿé™æ€èµ„æº

### 8. æ•…éšœæ’é™¤

#### å¸¸è§é—®é¢˜
1. **éƒ¨ç½²å¤±è´¥**
   ```bash
   # æ£€æŸ¥ç½‘ç»œè¿æ¥
   ping 152.32.218.174
   
   # æ£€æŸ¥SSHè¿æ¥
   ssh root@152.32.218.174 'echo "è¿æ¥æ­£å¸¸"'
   ```

2. **æœåŠ¡å¯åŠ¨å¤±è´¥**
   ```bash
   # æŸ¥çœ‹é”™è¯¯æ—¥å¿—
   ssh root@152.32.218.174 'cd /var/www/lianyu_ai && npm run logs'
   
   # æ£€æŸ¥ç«¯å£å ç”¨
   ssh root@152.32.218.174 'netstat -tlnp | grep :3001'
   ```

3. **ç¯å¢ƒé…ç½®é—®é¢˜**
   ```bash
   # é‡æ–°ç”Ÿæˆé…ç½®
   ./scripts/generate-config.js
   ./sync-env.sh production
   ```

### 9. æœªæ¥æ”¹è¿›è®¡åˆ’

#### çŸ­æœŸç›®æ ‡ (1-2å‘¨)
- [ ] æ·»åŠ è‡ªåŠ¨åŒ–æµ‹è¯•
- [ ] å®Œå–„é”™è¯¯ç›‘æ§
- [ ] ä¼˜åŒ–éƒ¨ç½²è„šæœ¬

#### ä¸­æœŸç›®æ ‡ (1ä¸ªæœˆ)
- [ ] å®æ–½CI/CDæµæ°´çº¿
- [ ] æ·»åŠ æ€§èƒ½ç›‘æ§
- [ ] é…ç½®è´Ÿè½½å‡è¡¡

#### é•¿æœŸç›®æ ‡ (3ä¸ªæœˆ)
- [ ] å®¹å™¨åŒ–éƒ¨ç½² (Docker)
- [ ] å¤šç¯å¢ƒç®¡ç† (dev/staging/prod)
- [ ] è‡ªåŠ¨æ‰©ç¼©å®¹

---

## ğŸ“ æ”¯æŒå’Œå¸®åŠ©

å¦‚æœåœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹æœ¬æ–‡æ¡£çš„æ•…éšœæ’é™¤éƒ¨åˆ†
2. è¿è¡Œ `./quality-check.sh all` è¿›è¡Œå…¨é¢æ£€æŸ¥
3. æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

**è®°ä½ï¼šæ¯æ¬¡ä¿®æ”¹åéƒ½è¦åŒæ­¥åˆ°æœåŠ¡å™¨ï¼Œä¿æŒæœ¬åœ°å’Œè¿œç¨‹ç¯å¢ƒä¸€è‡´ï¼**